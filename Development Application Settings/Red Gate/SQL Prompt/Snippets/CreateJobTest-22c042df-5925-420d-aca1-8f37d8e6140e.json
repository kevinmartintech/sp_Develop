{
  "id": "22c042df-5925-420d-aca1-8f37d8e6140e",
  "prefix": "CreateJobTest",
  "description": "Use this to test the SQL Server Agent Job status check",
  "body": "DROP TABLE IF EXISTS #CheckForJob;\r\nCREATE TABLE #CheckForJob (\r\n    JobId   int     NOT NULL IDENTITY(1, 1)\r\n   ,JobName sysname NOT NULL\r\n   ,enabled tinyint NOT NULL\r\n);\r\n\r\nINSERT INTO #CheckForJob (JobName, enabled)\r\nVALUES (N'Check Email Blocks', 0)\r\n   ,(N'Data Management - Operational Data Store - Integration - Address Change Service Sentara Export (Production)', 1)\r\n   ,(N'Data Management - Operational Data Store - Integration - Master (Production)', 1)\r\n   ,(N'Data Management - Operational Data Store - Integration - Secure Destruction Sentara Export (Production)', 1)\r\n   ,(N'Delete from DV_Vertification table', 1)\r\n   ,(N'EBPP Import US Bank Bounce Emails', 1)\r\n   ,(N'Extract_ZipFile', 1)\r\n   ,(N'Freedom Mortgage Bounce Back Process', 1)\r\n   ,(N'Huntington Econsent Tran File Generator', 0)\r\n   ,(N'ImportDirectMessagingTrackingBounces', 1)\r\n   ,(N'ImportDirectMessagingTrackingClicks', 1)\r\n   ,(N'ImportDirectMessagingTrackingData', 0)\r\n   ,(N'ImportDirectMessagingTrackingDelivered', 1)\r\n   ,(N'ImportDirectMessagingTrackingOpens', 1)\r\n   ,(N'ImportDirectMessagingTrackingSent', 1)\r\n   ,(N'ImportDirectMessagingTrackingUnsubs', 1)\r\n   ,(N'ImportStrongViewData', 0)\r\n   ,(N'MonitorImportDirectMessagingTrackingData', 1)\r\n   ,(N'MonitorWebloadHistory', 1)\r\n   ,(N'MTBank Bounce Back Process', 1)\r\n   ,(N'OneMain Bounce Back Process', 1)\r\n   ,(N'PLS Message Deletion', 1)\r\n   ,(N'PowerBIReports', 1)\r\n   ,(N'Purge SQL Job History', 1)\r\n   ,(N'Report_Dashboard_SP_SSIS', 1)\r\n   ,(N'Santander Bounce Back Process', 1)\r\n   ,(N'SantanderTestBounceback Process', 1)\r\n   ,(N'SOLR_Delta_Import_Index_SSIS', 0)\r\n   ,(N'sp_whoisactive trace', 0)\r\n   ,(N'SSIS Server Maintenance Job', 1)\r\n   ,(N'syspolicy_purge_history', 1)\r\n   ,(N'Update acctdtl table', 0)\r\n   ,(N'UpdateAcctnumClearText', 0)\r\n   ,(N'US Bank EAdoptionPDFsViewedByProdReport', 0)\r\n   ,(N'USBankPaymentReminderEmailExtract', 1)\r\n   ,(N'VA acctdtl_purge', 1)\r\n   ,(N'VA Export 72000ZVentureActiveUsers', 1)\r\n   ,(N'VA Export 80700ZReturnMail', 1)\r\n   ,(N'VA Export Delpdfexpire', 1)\r\n   ,(N'VA Export Docdelvaudit1', 1)\r\n   ,(N'VA Export Docdelvaudit2', 1)\r\n   ,(N'VA Export Docdelvaudit3', 1)\r\n   ,(N'VA Export Docdelvaudit4', 1)\r\n   ,(N'VA Export dvusage', 1)\r\n   ,(N'VA Export FlightChk', 1)\r\n   ,(N'VA Export flightchkbypass', 1)\r\n   ,(N'VA Export flightchkprods', 1)\r\n   ,(N'VA Export Letterids', 1)\r\n   ,(N'VA Export Messaging', 1)\r\n   ,(N'VA Export Messaging WOM', 1)\r\n   ,(N'VA Export NCSECUShippedJobsEmailNotification', 1)\r\n   ,(N'VA Export PNC', 1)\r\n   ,(N'VA Export Tipsnlinks', 1)\r\n   ,(N'VA ExportBellBankReservicesReport', 1)\r\n   ,(N'VA ExportPaychexYearEndVentureAccessReport', 1)\r\n   ,(N'VA ExportUSBankHardBounceReport', 1)\r\n   ,(N'VA Import Type1', 1)\r\n   ,(N'VA Import Type2', 1)\r\n   ,(N'VA ImportUnauthAcctnum', 1)\r\n   ,(N'VA Maintenance', 1)\r\n   ,(N'VA Messaging Cleanup', 1)\r\n   ,(N'VA Monitor', 1)\r\n   ,(N'VA NCSECU CustomReportGeneration', 1)\r\n   ,(N'VA user_id_inactivate_delete', 1)\r\n   ,(N'VA WebLoad Type1', 1)\r\n   ,(N'VA WebLoad Type2', 1)\r\n   ,(N'VENSSQL03 - Maintenance - uspBlockingNotify', 1)\r\n   ,(N'VENSSQL03 - sp_purge_jobhistory - High Traffic JobHistory', 1);\r\n\r\nSELECT\r\n    job_id  = COALESCE(s.job_id, NULL)\r\n   ,JobName = COALESCE(s.name, j.JobName)\r\n   ,Issue   = CASE WHEN s.name IS NULL\r\n                       THEN 'Job exists in #CheckForJob but not in dbo.sysjobs.'\r\n                  WHEN j.JobName IS NULL\r\n                      THEN 'Job exists in dbo.sysjobs but not in #CheckForJob.'\r\n                  WHEN s.enabled = 0\r\n                  AND j.enabled = 1\r\n                      THEN 'Job should be enabled.'\r\n                  WHEN s.enabled = 1\r\n                  AND j.enabled = 0\r\n                      THEN 'Job should be disabled.'\r\n                  ELSE 'Unknown case.'\r\n              END\r\nFROM\r\n    msdb.dbo.sysjobs         AS s\r\nFULL OUTER JOIN #CheckForJob AS j ON s.name = j.JobName\r\nWHERE\r\n    s.name IS NULL\r\nOR  j.JobName IS NULL\r\nOR  s.enabled <> j.enabled\r\nORDER BY\r\n    JobName ASC;\r\nGO"
}